(function(a){a.fn.ImxInfiniteScroll=function(d,j){var f=a.extend({api_url:"http://api.inventmx.com/v1",site:"salud180",repo:"nodes.json",api_key:"3a5877fc16b6fcbf8eedbe55d091938a",append:"body",loading:"http://m.salud180.com/img/salud180/ajax-loader.gif",analitics:true,category_analytics:"IMxInfiniteScroll",action_analytics:"Infinite-Scroll",label_analytics:"Numero-Scroll: ",IMxInit:function(){},IMxEnd:function(){}},d);var g=a.extend({sort:null,type:null,fields:null,limit:5,offset:null,audio:null,tag_ids:null,category_url:null,category_ids:null,programa_url:null,programa_ids:null,tag_url:null,callback:null,columnista_ids:null},j);var c=a(this).attr("id");var i=false;var h="";a(f.append).after("<div class='wrapper-loading'><img src='"+f.loading+"'/></div>");a(f.append+" img").each(function(){a(this).css({"background-image":"url("+f.loading+")"});a(this).addClass("loading")});if(g.offset){offset1=g.offset+g.limit;a("#"+c).attr("offset",offset1)}else{a("#"+c).attr("offset",g.limit)}var b=0;var e={analitics:function(){if(f.analitics){url=window.location.href;label=f.label_analytics+b;_gaq.push(["_trackEvent",url,f.category_analytics,f.action_analytics,label])}},init:function(){e.load()},load:function(){offset=parseInt(a("#"+c).attr("offset"));g.offset=offset;url=f.api_url+"/"+f.site+"/"+f.repo+"/"+f.api_key+"?callback=?";finaldata={};a.each(g,function(l,k){if(k){finaldata[l]=k}});e.getAjax(url,finaldata)},getAjax:function(l,k){i=true;a.ajax({url:l,data:k,dataType:"json",type:"GET",timeout:100000,contentType:"application/json; charset=utf-8",async:false,success:function(m){if(m.response.status==200){result=m.data;if(m){e.render(result)}else{alert("No hay mas datos")}i=false}else{c=a(block).attr("id");alert("Hubo un error inesperado, intenta nuevamente por favor");i=false}},error:function(o,m,n){alert("Hubo un error inesperado, intenta nuevamente por favor");i=false}})},render:function(k){i=false;b+=1;offset=parseInt(a("#"+c).attr("offset"));offset+=g.limit;a("#"+c).attr("offset",offset);tpl=a("#"+c).html();section=Handlebars.compile(tpl);h=section(k);a(f.append).append(h);a(".wrapper-loading").hide();e.analitics();f.IMxEnd();FB.XFBML.parse();twttr.widgets.load()}};a(window).scroll(function(){if((a(window).scrollTop()==a(document).height()-a(window).height())&&!i){e.init();f.IMxInit();a(".wrapper-loading").show()}})}})(jQuery);